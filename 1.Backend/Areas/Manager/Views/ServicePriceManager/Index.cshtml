@addTagHelper *, Sakura.AspNetCore.Mvc.PagedList
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@addTagHelper *, PT.UI
@{
    Layout = "~/Views/Shared/_Admin.cshtml";
}

<div grid-index data-url='@Url.Action("Index")'>
    <div class="row head-v2">
        <div class="col-md-4">
            <div class="block-header">
                <h2><i class="material-icons">assignment</i> QUẢN LÝ GIÁ DỊCH VỤ <span class="label label-danger label-t">Danh sách</span></h2>
                <ol class="breadcrumb breadcrumb-t">
                    <li>
                        <a href="/Admin">
                            Trang điều khiển
                        </a>
                    </li>
                    <li class="active">
                        Danh sách giá dịch vụ
                    </li>
                </ol>
            </div>
        </div>
        <div class="col-md-8">
            <div search-advance class="input-group mb-0">
                <div class="input-group-addon input-group-addon-t">
                    <span class="text-addonsearch">Tìm kiếm</span>
                </div>
                <div class="divcansearch">
                    <input grid-input type="text" name="key" class="form-control inputsearch keywidth" placeholder="Tìm theo tên">
                    <div search-form class="searchExtensionForm">
                        <a search-close title="Đóng" class="btnCloseSearchEx"><span aria-hidden="true">×</span></a>
                        <div class="row">
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label class="form-label">Trạng thái</label>
                                    <div class="controls">
                                        <input @(Context.Request.Query["status"].ToString() == "" ? "checked='checked'" : "") grid-input type="radio" id="radio_0" value="" name="status" class="with-gap radio-col-blue" />
                                        <label for="radio_0" class="labelradio">Tất cả</label>
                                        &nbsp;
                                        <input @(Context.Request.Query["status"].ToString() == "true" ? "checked='checked'" : "") grid-input type="radio" id="radio_2" value="true" name="status" class="with-gap radio-col-green" />
                                        <label for="radio_2" class="labelradio">Sử dụng</label>
                                        &nbsp;
                                        <input @(Context.Request.Query["status"].ToString() == "false" ? "checked='checked'" : "") grid-input type="radio" id="radio_3" value="false" name="status" class="with-gap radio-col-red" />
                                        <label for="radio_3" class="labelradio">Không sử dụng</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <a search-menu class="searchExtension" title="Tìm kiếm nâng cao"><i class="material-icons">keyboard_arrow_down</i></a>
                </div>
                <span class="input-group-addon btn-group-addon">
                    <button onclick="getDataGrid(1)" type="button" class="btn bg-indigo waves-effect btn-search"><i class="material-icons">search</i></button>
                </span>
                <div class="input-group-addon btn-group-addon pl-10">
                    <div class="btn-group">
                        <button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <i class="material-icons">add</i><span>Thêm mới</span> <span class="caret"></span>
                        </button>
                        <ul class="dropdown-menu drcontrol">
                            @foreach (var item in PT.Shared.ListData.ListLanguage)
                            {
                                <li><a button-popup data-target="#myModal" asp-action="Create" asp-route-language="@item.Id"><img src="@item.Icon" /> @item.Name</a></li>
                            }
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row clearfix">
        <div class="col-md-12">
            <div grid-loading class="card card-t card-loading">
                <div class="header bg-indigo">
                    <h4 grid-num-row class="num-t m-l-20">
                        Đang tải...
                    </h4>
                    <ul class="header-dropdown m-r--5 header-dropdown-t">
                        <li class="dropdown">
                            <a href="javascript:void(0);" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
                                <i class="material-icons">apps</i>
                            </a>
                            <ul class="dropdown-menu pull-left">
                                <li><a href="javascript:void(0);">Đóng lại</a></li>
                            </ul>
                        </li>
                    </ul>
                    <div class="controlOrderBy">
                        <div style="width:110px;" class="itemorder selectOrder">
                            <select grid-input onchange="getDataGrid(1)" data-header="Loại sắp xếp" name="ordertype" class="form-control input-sm form-control-t show-tick">
                                <option data-icon="glyphicon-sort-by-attributes" value="asc">Tăng dần</option>
                                <option data-icon="glyphicon-sort-by-attributes-alt" value="desc">Giảm dần</option>
                            </select>
                        </div>
                        <div style="width:200px;" class="itemorder selectOrder">
                            <select grid-input onchange="getDataGrid(1)" data-header="Xắp xếp theo" name="orderby" class="form-control input-sm form-control-t show-tick">
                                <option data-icon="glyphicon glyphicon-sort" value="datePosted">Xếp theo thời gian đăng</option>
                                <option data-icon="glyphicon glyphicon-sort" value="name">Xếp theo tên hiển thị</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="body body-t">
                    <partial name="_TabLanguage" model="@(new PT.Domain.Model.TabLanguageModel { Language = Context.Request.Query["language"] })" />
                    <div>
                        <table class="table table-striped table-bordered table-hover table-t">
                            <thead>
                                <tr>
                                    <th class="text-center" style="width:50px;">TT</th>
                                    <th>Tên</th>
                                    <th style="width:300px;">Giá</th>
                                    <th style="width:80px;">Thứ tự</th>
                                    <th style="width:90px;">Hành động</th>
                                </tr>
                            </thead>
                            <tbody grid-data></tbody>
                        </table>
                    </div>
                    <div class="pl-20 pr-20 divpagination">
                        <div class="row">
                            <div class="col-md-2">

                            </div>
                            <div class="col-md-10">

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
    <script>
        var _page = 1;
        var _pageImage = 1;
        $(function () {
            getDataGrid(1, true);
            $("[search-advance]").toSearch();
            $("[button-popup]").toPopup();
            $("[button-submit]").toSubmit(function (rs, $this, type) {
                if (type == "CreateImage" || type == "EditImage") {
                    reGetDataGridImage();
                }
                else {
                    reGetDataGrid();
                }
            });
            $("[button-delete]").toDelete(function (rs, $this, returnurl, buttonType) {
                if (buttonType == "DeleteImage") {
                    reGetDataGridImage();
                }
                else {
                    reGetDataGrid();
                }
            });

            $("[button-static]").toStaticForm(function ($this) { });
            $("[button-edit-grid]").toEditGrid(function ($this) {

            });
            $("[button-table-edit-cancel]").toCancelEditGrid();

        });

        function getDataGrid(page, first = false) {
            _page = page;
            $("[grid-index]").toGridView(first, page);
        }
        function reGetDataGrid(e) {
            if (e != null) {
                _page = 1;
                $("[name='language']").val($(e).attr("data-val"));
                $("[name='categoryId']").val("").selectpicker('refresh');
            }
            getDataGrid(_page, false);
        }

        function getDataGridImage(page, first = false) {
            _pageImage = page;
            $("[grid-index-Image]").toGridView(first, page);
        }
        function reGetDataGridImage() {
            getDataGridImage(_pageImage, false);
        }
        function initSubParent() {
            if ($("[name='SubParent']").prop("checked") == true) {
                $(".notParrent").hide();
            }
            else {
                $(".notParrent").show();
            }
        }
         $(document).on("change", "[name='SubParent']", function () {
            initSubParent();
         });


        $(document).on("change", "[name='ContactPrice']", function () {
            initContactPrice();
         });
      function initContactPrice() {
          if ($("[name='ContactPrice']").prop("checked") == true) {
              $(".serviceprice .gialienhe").hide();
              $(".serviceprice input[type='number']").val("0");
              $(".serviceprice input[type='text']").val("Không");
            }
          else {
              $(".serviceprice .gialienhe").show();
            }
        }
    </script>
}
