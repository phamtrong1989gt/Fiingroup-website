@using Microsoft.AspNetCore.Http
@inject Microsoft.AspNetCore.Http.IHttpContextAccessor _httpContextAccessor
@{
    var isLogin = PT.Base.DataUserInfo.IsLogin;
    //var isLogin = true;
    //int? isView = Convert.ToInt32(_httpContextAccessor.HttpContext.Request.Cookies["AdminView"]);
    int? isView = 1;
}
@if (isLogin)
{
    <style>

      
        .editcontrol {
            display: inline-block;
            position: absolute;
            top: 0;
            right: 0;
            background-color: red;
            color: #fff;
            z-index: 9999;
            text-decoration: none;
        }

            .editcontrol:hover {
                background-color: brown;
                text-decoration: none;
                color: #fff;
            }

        .editcontrol {
            display: inline-block !important;
            position: absolute;
            top: 0;
            right: 0;
            background-color: red;
            color: #fff !important;
            z-index: 9999;
            text-decoration: none;
            padding: 0px 10px;
            font-size: 12px;
            color: #fff;
            font-weight: 500;
            box-shadow: -1px 2px 6px #555;
        }

            .editcontrol a {
                color: #fff;
            }

        .menuadmin {
            position: fixed;
            top: 0px;
            right: 0;
            border-right: 0;
            width: 100%;
            height: 35px;
            background-color: #fff;
            z-index: 99999999;
        }

        .boxed_wrapper {
            margin-top: 38px;
        }

        .menuadmin .navbar {
            border-radius: 0;
            border-left: 0;
            border-right: 0;
            min-height: 35px;
            padding: 2px 10px;
        }

        .menuadmin .nav > li > a {
            padding: 10px 12px;
            font-size: 13px;
            font-weight: 500;
            color: #fff;
        }

        .menuadmin .navbar-brand {
            height: 30px;
            padding: 2px 0px;
            font-weight: bold;
        }

        .menuadmin .navbar-form {
            margin-top: 0;
            margin-bottom: 0;
        }

        .navbar-default {
            background-color: #3f51b5;
            border-color: #2d40a8;
        }

        .menuadmin .nav > li.active > a {
            background-color: #2d40a8;
            color: #fff;
        }

        .menuadmin .nav > li a:hover {
            background-color: #2d40a8 !important;
            color: #fff !important;
        }


        .menuadmin .nav > li:hover > a {
            color: #fff;
        }

        .menuadmin .nav > li:hover {
            background-color: #2d40a8;
        }

        .btnadmin {
            text-transform: none;
            border: 1px solid;
            background: #3b4d9c;
        }

        .menuadmin .navbar {
            border-bottom: 2px solid #314555;
        }

        .menuadmin select.input-sm {
            height: 26px !important;
            line-height: 36px !important;
            padding: 0px 8px !important;
            min-height: 35px !important;
        }

        .navmenuedit {
        }

            .navmenuedit li {
                float: left;
                display: inline-block;
            }

        .adminlink a {
            color: #fff;
            margin-left: 5px;
            margin-right: 5px;
            text-decoration: none;
            font-size:13px;
        }

        .adminlink {
            position: absolute;
            left: 112px;
        }
        #chedoxemadmin {
            height: 26px !important;
            line-height: 27px !important;
            padding: 0px 5px !important;
            min-height: 27px !important;
            border-radius: 0;
            font-size: 13px;
        }
        .adminlink a:hover {
            color: #cecece;
        }
    </style>

@*     <div class="menuadmin">
        <nav class="navbar navbar-default">
            <div class="container-fluid">
                <div class="navbar-header">
                    <a href="/Admin" style="color:#fff;" class="navbar-brand">T-CMS</a>
                </div>
                <div class="adminlink">
                    <a href="/Admin">Trang quản trị</a>
                    <a href="#" onclick="logout()">Thoát</a>
                </div>

                <div class="navbar-form navbar-right">
                    @if (ViewData["UrlAdmin"] != null)
                    {
                        <div class="form-group" style="margin-right: 20px;">
                            <a target="_blank" href="@ViewData["UrlAdmin"]" class="btn btn-primary btn-sm btnadmin"><span class="fa fa-pencil"></span> Chỉnh sửa trang này </a>
                        </div>
                    }
                    <select style="background: #fff;border: 1px solid #2d40a8;" data-url="@Context.Request.Path" class="form-control input-sm" id="chedoxemadmin">
                        @if (isView == 1)
                        {
                            <option value="1" selected>Chế độ xem quản trị</option>
                            <option value="0">Chế độ xem người dùng</option>
                        }
                        else
                        {
                            <option value="1">Chế độ xem quản trị</option>
                            <option value="0" selected>Chế độ xem người dùng</option>
                        }
                    </select>
                </div>
            </div>
        </nav>
    </div> *@

    if (isView == 1)
    {
        <style>
            .formadmin {
                position: relative;
                border: 2px dotted red;
                overflow: hidden;
                opacity: 0.5;
            }

                .formadmin:hover {
                    opacity: 1;
                    z-index: 99999;
                }
        </style>
        <script>
            $(function () {
                var $data = $(".formadmin");
                $data.each(function (i, data) {
                    var $this = $(data).find(".bindata");
                    $this.html("<a target='_blank' href='" + $this.attr("data-href") + "' class='editcontrol'><i class='fa fa-pencil'></i> Chỉnh sửa</a>")
                });
            });
        </script>
    }
<script>
        $("#chedoxemadmin").on("change",function() {
           var $this = $(this);
            $.post('admin/AdminView', { status: $this.val() }, function () {
              window.location.href = $this.attr("data-url");
           });
       });
        function logout() {
            $("#formLogout").submit();
        }
             $(document).on('click', '.editcontrol', function (e) {
            e.preventDefault();
            var url = $(this).attr('href');
            var width = 1000;
            var height = 700;
            var left = (window.screen.width / 2) - (width / 2);
            var top = (window.screen.height / 2) - (height / 2);
            var popup = window.open(
                url,
                'popupWindow',
                'width=' + width +
                ',height=' + height +
                ',top=' + top +
                ',left=' + left +
                ',scrollbars=yes'
            );
            // Theo dõi popup, khi đóng thì reload lại trang chính
            var timer = setInterval(function () {
                if (popup.closed) {
                    clearInterval(timer);
                    window.location.reload();
                }
            }, 500);
        });
</script>
    <form id="formLogout" method="post" asp-action="LogOut" asp-controller="Account" asp-area="User">
        @Html.AntiForgeryToken()
    </form>
}